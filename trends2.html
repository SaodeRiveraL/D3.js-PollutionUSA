<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap 4 Website Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>

  <script type="text/javascript">

  </script>
  <style>
  .fakeimg {
    height: 200px;
    background: #aaa;
  };
    /* Make the image fully responsive */
    .carousel-inner img {
      width: 100%;
      height: 100%;
    }
 
    div.transbox {
      margin: 30px;
      background-color: white;
      border: 1px solid white;
      opacity: 0.6;
      border-radius: 20px;
      height: 500px;
    }

    div.transboxtitle {
      margin-top: 30px;
      margin-left: 10px;
      background-color: white;
      border: 1px solid white;
      opacity: 0.6;
      border-radius: 20px;
      height: 300px;
    }

    /* Style for Custom Tooltip */
    div.tooltip {   
 	    position: absolute;           
	    text-align: center;           
	    width: 80px;                  
	    height: 32px;                 
	    padding: 2px;             
	    font: 12px sans-serif;        
	    background: black;   
	    border: 0px;      
	    border-radius: 8px;           
	    pointer-events: none;  
        color:white       
    }


   div.transbox p {
     margin: 2%;
     color:white;
    }

    .bar {
            fill:#c83349;
        }

   </style>
  
</head>
<body style="background-color: whitesmoke;background-image: url('./resources/back4.jpg');">
<div class="container-fluid">
  <div class = "row" style="background-color: black;">
    <div class="col-6 col-sm-4" style="background-color: black;color:white;font-size: xx-large;">
       <p style="padding-top: 10px; padding-left: 50px;">Pollution in US 2000-2016</p>
    </div>
    <div class="col-6 col-sm-8" style="background-color: black;color:white;font-size: xx-large;padding: 10px;">
        <a href="index.html"><img src="./resources/home0.ico" alt="Home" style="height: 40px;"></a>
        <a href="#demo1" class="btn btn-dark" data-toggle="collapse">Trends</a>
        <a href="#demo2" class="btn btn-dark" data-toggle="collapse">Animations</a>
        <a href="#demo3" class="btn btn-dark" data-toggle="collapse">HeatMaps</a>
        <a href="info.html"><img src="./resources/info.ico" alt="Home" style="height: 40px;"></a>
        <div id="demo1" class="collapse" style="font-size: large;">
            These graphics show the trends of the pollutants 
            <ul>
                <li><a href="trends1.html" style="color:white;">Pollutants per State</a></li>
                <li><a href="trends2.html" style="color:white;">Pollutants per Year</a></li>
            </ul>
         </div>
         <div id="demo2" class="collapse" style="font-size: large;" > 
            Trends of Pollutants by State
            <ul>
                <li><a href="animation1.html" style="color:white;">Trends by State</a></li>
            </ul>
          </div>
        <div id="demo3" class="collapse" style="font-size: large;">
          Heat Map of US by type of pollutant
          <ul>
            <li><a href="Map01.html" style="color:white;">Trends by State</a></li>
          </ul>
     
        </div>
         
    </div>
  </div>
</div> 

<div class="container-fluid" style="margin-top:30px;color:white">
    <div class=row>
        <div class= 'col-sm-2'>
            <div class ='transboxtitle' >
                <p>Choose State:</p>
                <div style="padding-left: 20px;">
                    <p style='color:black;'>Year :</p>
                    <select id="year" name="year" style="background:rgb(0, 0, 0);color: white;padding: 5px;">
                        <option value="2000">2000</option>
                        <option value="2001">2001</option>
                        <option value="2002">2002</option>
                        <option value="2003">2003</option>
                        <option value="2004">2004</option>
                        <option value="2005">2005</option>
                        <option value="2006">2006</option>
                        <option value="2007">2007</option>
                        <option value="2008">2008</option>
                        <option value="2009">2009</option>
                        <option value="2010">2010</option>
                        <option value="2011">2011</option>
                        <option value="2012">2012</option>
                        <option value="2013">2013</option>
                        <option value="2014">2014</option>
                        <option value="2015">2015</option>
                        <option value="2016">2016</option>
                    </select>
                    <p style='color:black;margin-top: 10px;'>State :</p>
                    <select id="State" name="State" style="background:rgb(0, 0, 0);color: white;padding: 5px;">
                        <option value = 'Alabama'>Alabama</option>
                        <option value = 'Alaska'>Alaska</option>
                        <option value = 'American Samoa'>American Samoa</option>
                        <option value = 'Arizona'>Arizona</option>
                        <option value = 'Arkansas'>Arkansas</option>
                        <option value = 'California'>California</option>
                        <option value = 'Colorado'>Colorado</option>
                        <option value = 'Connecticut'>Connecticut</option>
                        <option value = 'Delaware'>Delaware</option>
                        <option value = 'District of Columbia'>District of Columbia</option>
                        <option value = 'Florida'>Florida</option>
                        <option value = 'Georgia'>Georgia</option>
                        <option value = 'Hawaii'>Hawaii</option>
                        <option value = 'Idaho'>Idaho</option>
                        <option value = 'Illinois'>Illinois</option>
                        <option value = 'Indiana'>Indiana</option>
                        <option value = 'Iowa'>Iowa</option>
                        <option value = 'Kansas'>Kansas</option>
                        <option value = 'Kentucky'>Kentucky</option>
                        <option value = 'Louisiana'>Louisiana</option>
                        <option value = 'Maine'>Maine</option>
                        <option value = 'Maryland'>Maryland</option>
                        <option value = 'Massachusetts'>Massachusetts</option>
                        <option value = 'Michigan'>Michigan</option>
                        <option value = 'Minnesota'>Minnesota</option>
                        <option value = 'Mississippi'>Mississippi</option>
                        <option value = 'Missouri'>Missouri</option>
                        <option value = 'Montana'>Montana</option>
                        <option value = 'Nevada'>Nevada</option>
                        <option value = 'New Hampshire'>New Hampshire</option>
                        <option value = 'New Jersey'>New Jersey</option>
                        <option value = 'New Mexico'>New Mexico</option>
                        <option value = 'New York'>New York</option>
                        <option value = 'North Carolina'>North Carolina</option>
                        <option value = 'North Dakota'>North Dakota</option>
                        <option value = 'Ohio'>Ohio</option>
                        <option value = 'Oklahoma'>Oklahoma</option>
                        <option value = 'Oregon'>Oregon</option>
                        <option value = 'Pennsylvania' selected>Pennsylvania</option>
                        <option value = 'Puerto Rico'>Puerto Rico</option>
                        <option value = 'Rhode Island'>Rhode Island</option>
                        <option value = 'South Carolina'>South Carolina</option>
                        <option value = 'South Dakota'>South Dakota</option>
                        <option value = 'Tennessee'>Tennessee</option>
                        <option value = 'Texas'>Texas</option>
                        <option value = 'Utah'>Utah</option>
                        <option value = 'Vermont'>Vermont</option>
                        <option value = 'Virgin Islands'>Virgin Islands</option>
                        <option value = 'Virginia'>Virginia</option>
                        <option value = 'Washington'>Washington</option>
                        <option value = 'West Virginia'>West Virginia</option>
                        <option value = 'Wisconsin'>Wisconsin</option>
                        <option value = 'Wyoming'>Wyoming</option>
                      </select>
                      <br>
                      <botton style="color:white;background:black;margin-top: 10px;" onclick="update()" class="btn">Execute</botton>
                    </div>
    

            </div>

        </div>
        <div class='col-sm-5'>
            <div class="transbox" id="div01">
            </div>
            <div class="transbox" id="div03">
            </div>


        </div>
        <div class='col-sm-5'>
            <div class="transbox" id="div02">
            </div>
            <div class="transbox" id="div04">
            </div>
        </div>

    </div>
</div>

<div class="container-fluid" style="margin-bottom:0; background-color: black; color:white;">
    <div class="row">
        <div class="col" >
            <div class="row">
                <div class="col" style="padding: 10px;text-align: right;">
                    <img src="./resources/Balam1.png" alt="Balam">
                </div>
                
                <div class="col" style="padding: 10px;">
                    Lilian Sao de Rivera
                    Summer 2020
                </div>
                <div class="col">
                </div>

            </div>
        </div>
        <div class="col" ></div>
        <div class="col" style="padding: 10px;display: inline;" >
            <div class="row">
                <div class="col" style="text-align: right;">
                    <img src="./resources/gw.png" alt="gw" width="60px" height="60px">
                </div>
                <div class="col">
                    Visualization of Complex Data
                    Prof. Nima Zahadat
                </div>            
        </div>
      </div>
    
</div>

<script>

DrawAll();

function update(){

    d3.select("#svg01").remove();
    d3.select("#svg02").remove();
    d3.select("#svg03").remove();
    d3.select("#svg04").remove();
    DrawAll();

};

function DrawAll(){

 //Create SVG element and append map to the SVG

    var width = 600;
    var height = 530;

    var svg = d3.select("#div01")
            .append("svg")
            .attr("id", "svg01")
            .attr("width", width)
            .attr("height", height);


        
    var svg = d3.select("#div02")
            .append("svg")
            .attr("id", "svg02")
            .attr("width", width)
            .attr("height", height);

    var svg = d3.select("#div03")
            .append("svg")
            .attr("id", "svg03")
            .attr("width", width)
            .attr("height", height);

    var svg = d3.select("#div04")
            .append("svg")
            .attr("id", "svg04")
            .attr("width", width)
            .attr("height", height);

            // Append Div for tooltip to SVG
    var div = d3.select('#div01')
            .append("div") 
            .attr("id","tooltip01")  
            .attr("class", "tooltip")               
            .style("opacity", 0);

                    // Append Div for tooltip to SVG
    var div = d3.select('#div02')
            .append("div") 
            .attr("id","tooltip02")  
            .attr("class", "tooltip")               
            .style("opacity", 0);

                    // Append Div for tooltip to SVG
    var div = d3.select("#div03")
            .append("div") 
            .attr("id","tooltip03")  
            .attr("class", "tooltip")               
            .style("opacity", 0);

                    // Append Div for tooltip to SVG
    var div = d3.select("#div04")
            .append("div") 
            .attr("id","tooltip04")  
            .attr("class", "tooltip")               
            .style("opacity", 0);


    var xstate = document.getElementById('State').value;
    var xyear = document.getElementById('year').value;

    DrawScatter('NO2', '#svg01',xstate, xyear, "#tooltip01");
    DrawScatter('O3', '#svg02',xstate, xyear, "#tooltip02");
    DrawScatter('SO2', '#svg03',xstate, xyear,"#tooltip03");
    DrawScatter('CO', '#svg04',xstate, xyear), "#tooltip04";

};

function DrawScatter(xpollutant = 'NO2', xid, xstate = 'Pennsylvania', xyear=2000, xid_div) {

    var xtitle = xpollutant 

    var svg = d3.select(xid),
        margin = 200,
        width = svg.attr("width") - margin,
        height = svg.attr("height") - margin;

    var div = d3.select(xid_div);

    svg.append("text")
       .attr("transform", "translate(100,0)")
       .attr("x", 130)
       .attr("y", 50)
       .attr("font-size", "24px")
       .text(xtitle)

    var xScale = d3.scaleBand().range([0, width]).padding(0.4),
        yScale = d3.scaleLinear().range([height, 0]);

    var xScale_days = d3.scaleBand().range([0, width]).padding(0.4),
        yScale_months = d3.scaleBand().range([height, 0]);

    xScale_days.domain(['Monday','Tuesday','Wenesday','Thrusday','Fridaay','Saturday','Sunday']);
    yScale_months.domain(['January','February','March','Abril','May','June','July','August','September','October','November','December']);
    
    var months = ['January','February','March','Abril','May','June','July','August','September','October','November','December']

    var g = svg.append("g")
               .attr("transform", "translate(" + 80 + "," + 100 + ")");

    d3.csv("./data/byDay.csv", function(error, data) {
        if (error) {
            throw error;
        }

        data = data.filter(function(d){ return (d.year == xyear); });
        data = data.filter(function(d){ return (d.State == xstate); });
  
        xScale.domain([1,2,3,4,5,6,7]);
        yScale.domain([0,12]);
 
        g.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(xScale_days))
            .selectAll("text")	
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", ".15em")
            .attr("transform", "rotate(-65)");

        g.append("g")
         .call(d3.axisLeft(yScale_months).tickFormat(function(d){
             return d
         })
         .ticks(10))
         .append("text")
         .attr("transform", "rotate(-90)")
         .attr("y", 1)
         .attr("dy", "-5.1em")
         .attr("text-anchor", "end")
         .attr("stroke", "black");

         
         svg.selectAll("circle")
            .data(data)
            .enter()
            .append("circle")
            .attr("cx", function(d) {
                return xScale(d.dayofweek)+ 100;
            })
            .attr("cy", function(d) {
                 return yScale(d.month) + 100;
            })
            .attr("r", function(d) {
                if (xpollutant=='NO2') {
                    return d.NO2/4 ; 
                } ;

                if (xpollutant=='O3') {
                    return d.O3 * 180 ; 
                } ;

                if (xpollutant=='SO2') {
                    return d.SO2 / 1.5 ; 
                } ;

                if (xpollutant=='CO') {
                    return d.CO * 10 ; 
                } ;


            })
            .style("fill",  "red")	
            .style("opacity", 0.15)
            // Modification of custom tooltip code provided by Malcolm Maclean, "D3 Tips and Tricks" 
            // http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html
            .on("mouseover", function(d) {      
                div.transition()        
                  .duration(200)      
                  .style("opacity", .9);      
                   div.text(d.City)
                   .style("left", (d3.event.pageX-350) + "px")     
                   .style("top", (d3.event.pageY-100) + "px")
                   .style("color","white");    
            })   
        
            // fade out tooltip on mouse out               
            .on("mouseout", function(d) {       
                div.transition()        
                   .duration(500)      
                   .style("opacity", 0);   
            });

         
    });


}

</script>


</body>
</html>
